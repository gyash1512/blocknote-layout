/* Multi-column layout styles for BlockNote */

.bn-block-column-list {
  display: flex;
  gap: 0;
  width: 100%;
  position: relative;
  /* Ensure resize handles that stick out top are visible */
  overflow: visible;
  margin-top: 12px; /* Space for top handles */
}

.bn-block-column {
  flex-grow: 1;
  flex-basis: 0;
  min-width: 50px;
  position: relative;
  /* Add padding-top to reserve space for the resize handles */
  padding: 12px 24px 0 24px; 
  box-sizing: border-box;
  transition: flex-grow 0.1s ease-out;
}

.bn-block-column:first-child {
  padding-left: 0;
}

.bn-block-column:last-child {
  padding-right: 0;
}

/* Divider lines between columns using border-right */
.bn-block-column-list[data-show-dividers="true"] .bn-block-column:not(:last-child) {
  border-right: var(--divider-width, 1px) solid var(--divider-color, #e9ecef);
}

/* 
   Resize Handles - Horizontal Bars ("Header Tabs")
   Positioned inside the top padding area.
   Width: 40px, Height: 6px.
*/
.bn-block-column::before,
.bn-block-column::after {
  content: "";
  position: absolute;
  top: 3px; /* Inside top padding */
  width: 40px;
  height: 6px;
  
  /* Visual Styling */
  background-color: rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  
  cursor: col-resize;
  z-index: 100;
  
  /* Hidden by default, visible on hover */
  opacity: 0;
  transition: opacity 0.1s, background-color 0.1s, transform 0.1s;
  pointer-events: auto;
}

/* Top-Right Handle (aligned to right edge) */
.bn-block-column::before {
  right: 2px; /* Slight offset from border */
}

/* Top-Left Handle (aligned to left edge) */
.bn-block-column::after {
  left: 2px; /* Slight offset from border */
}

/* Visibility Rules */

/* Hide Right handle on last column */
.bn-block-column:last-child::before {
  display: none;
}

/* Hide Left handle on first column */
.bn-block-column:first-child::after {
  display: none;
}

/* Show handles fully on hover - ONLY if editor is editable */
.ProseMirror[contenteditable="true"] .bn-block-column:hover::before,
.ProseMirror[contenteditable="true"] .bn-block-column:hover::after {
  opacity: 1;
}

/* Hover state for the handle itself - ONLY if editor is editable */
.ProseMirror[contenteditable="true"] .bn-block-column::before:hover,
.ProseMirror[contenteditable="true"] .bn-block-column::after:hover {
  background-color: rgba(0, 0, 0, 0.5); /* Darker on hover */
  transform: scaleY(1.2);
  z-index: 101;
}

/* Interaction States during Resizing */

/* When resizing starts globally, hide ALL handles by default to reduce clutter */
.is-resizing-columns .bn-block-column::before,
.is-resizing-columns .bn-block-column::after {
  opacity: 0 !important;
  pointer-events: none; /* Prevent switching handles mid-drag */
}

/* But SHOW the specific handle being dragged */
/* If resizing Right Edge of this column */
.is-resizing-columns .bn-block-column.resizing-col-right::before {
  opacity: 1 !important;
  background-color: #888; /* Highlight active */
  transform: scaleY(1.5);
}

/* Show vertical line for Right Edge resizing */
.is-resizing-columns .bn-block-column.resizing-col-right {
  box-shadow: inset -2px 0 0 0 #888;
}

/* If resizing Left Edge of this column */
.is-resizing-columns .bn-block-column.resizing-col-left::after {
  opacity: 1 !important;
  background-color: #888; /* Highlight active */
  transform: scaleY(1.5);
}

/* Show vertical line for Left Edge resizing */
.is-resizing-columns .bn-block-column.resizing-col-left {
  box-shadow: inset 2px 0 0 0 #888;
}

/* Mobile Styles */
@media (max-width: 480px) {
  .bn-block-column-list {
    /* Maintain desktop-like row layout */
    flex-direction: row;
    flex-wrap: nowrap;
    margin-top: 12px;
  }

  .bn-block-column {
    /* Allow columns to shrink to fit screen */
    min-width: 0;
    flex-shrink: 1;
    
    /* Compact padding */
    padding: 12px 4px 0 4px;
    
    /* Scale down text to simulate "zoomed out" view, preserving line breaks/density */
    font-size: 0.65em;
    line-height: 1.3;
  }

  /* Ensure dividers are vertical */
  .bn-block-column-list[data-show-dividers="true"] .bn-block-column:not(:last-child) {
    border-right: var(--divider-width, 1px) solid var(--divider-color, #e9ecef);
    border-bottom: none;
  }

  /* Hide resize handles on mobile as they are difficult to use at this scale */
  .bn-block-column::before,
  .bn-block-column::after {
    display: none;
  }
}

/* Tablet Styles */
@media (min-width: 481px) and (max-width: 768px) {
  .bn-block-column-list {
    flex-wrap: wrap;
  }
  .bn-block-column {
    min-width: calc(50% - 16px);
  }
}

/* Block adjustments */
.bn-block-column > .bn-block-outer {
  margin: 0;
}

/* Animation for column width changes */
.bn-block-column {
  transition: flex-grow 0.1s ease-out;
}

/* Prevent text selection while resizing */
.bn-block-column-list.resizing * {
  user-select: none;
}